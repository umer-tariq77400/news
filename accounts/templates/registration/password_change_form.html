{% extends "base.html" %}

{% block title %}Change Password{% endblock title %}

{% block content %}
<main class="flex flex-1 items-center justify-center px-4 py-12">
  <div class="w-full max-w-md">
    <!-- Card Container -->
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-border-subtle dark:border-border-subtle-dark overflow-hidden">
      <!-- Header -->
      <div class="px-8 pt-8 pb-6 text-center border-b border-border-subtle dark:border-border-subtle-dark">
        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-4">
          <span class="material-symbols-outlined text-3xl text-primary">lock</span>
        </div>
        <h2 class="text-3xl font-bold text-text-main dark:text-text-main-dark font-display">Change Password</h2>
        <p class="text-text-muted dark:text-text-muted-dark mt-2">For security, please enter your old password and then your new password twice</p>
      </div>

      <!-- Form Content -->
      <div class="px-8 py-6">
        <form method="post" class="space-y-5">
          {% csrf_token %}
          
          {% if form.non_field_errors %}
          <div class="rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 p-4">
            <div class="flex items-start gap-3">
              <span class="material-symbols-outlined text-red-600 dark:text-red-400">error</span>
              <div class="text-sm text-red-800 dark:text-red-200">
                {{ form.non_field_errors }}
              </div>
            </div>
          </div>
          {% endif %}

          {% for field in form %}
          <div>
            <label for="{{ field.id_for_label }}" class="block text-sm font-semibold text-text-main dark:text-text-main-dark mb-2">
              {{ field.label }}
            </label>
            <div class="relative">
              <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-muted dark:text-text-muted-dark text-xl">
                {% if 'old' in field.name %}lock_open{% else %}lock{% endif %}
              </span>
              <input type="password" 
                     name="{{ field.name }}" 
                     id="{{ field.id_for_label }}"
                     class="w-full pl-11 pr-4 py-3 rounded-lg border-2 border-border-subtle dark:border-border-subtle-dark bg-background-light dark:bg-gray-700 text-text-main dark:text-text-main-dark focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all placeholder:text-text-muted dark:placeholder:text-text-muted-dark"
                     placeholder="Enter password"
                     {% if field.field.required %}required{% endif %}>
            </div>
            {% if field.errors %}
              <p class="mt-1 text-sm text-red-600 dark:text-red-400">{{ field.errors.0 }}</p>
            {% endif %}
            {% if field.help_text %}
              <div class="mt-1 text-xs text-text-muted dark:text-text-muted-dark">
                {{ field.help_text|safe }}
              </div>
            {% endif %}
          </div>
          {% endfor %}

          <!-- Submit Button -->
          <button type="submit" class="w-full flex items-center justify-center gap-2 py-3 px-4 bg-primary hover:bg-primary/90 text-white font-bold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">
            <span>Change Password</span>
            <span class="material-symbols-outlined text-xl">check</span>
          </button>
        </form>
      </div>

      <!-- Footer -->
      <div class="px-8 py-6 bg-gray-50 dark:bg-gray-900/50 border-t border-border-subtle dark:border-border-subtle-dark text-center">
        <p class="text-sm text-text-muted dark:text-text-muted-dark">
          <a href="{% url 'profile' user.pk %}" class="font-semibold text-primary hover:text-primary/80 transition-colors">Back to profile</a>
        </p>
      </div>
    </div>
  </div>
</main>
{% endblock content %}
